import matplotlib.pyplot as plt
import numpy as np
from math import*

x = np.arange(-1,393,1)
f = ([6.370065 , 6.370065 , 5.835327 , 5.30059 , 4.765852,  5.567959 , 6.637434,
                6.904803,  6.904803,  6.370065 , 6.370065 , 5.835327 , 5.30059 ,5.033221,
                5.033221 , 5.30059 , 6.102696,  6.904803 , 7.172172,  7.172172 , 6.637434,
                6.102696 , 5.567959,  5.033221  ,4.498483,  3.963745 , 3.696376 , 3.963745,
                3.963745 , 4.498483 , 5.033221,  5.835327  ,6.102696 , 6.637434  ,6.904803,
                7.172172  ,7.172172,  7.172172 ,4.39541,  6.904803 , 6.370065,  5.835327,
                5.033221 , 4.498483 , 4.231114 , 5.033221 , 6.102696 , 6.637434 , 6.370065,
                5.835327  ,5.033221 , 4.498483  ,4.498483 , 4.498483 , 5.033221 , 5.30059,
                6.102696 , 6.904803 , 8.241648,  8.241648 , 8.509017 , 8.509017 , 8.509017,
                8.509017 , 8.241648 , 7.974279 , 8.509017,  9.311124  ,10.647969 , 11.182707,
                12.252182 , 13.054289  ,13.589027 , 13.589027 , 13.589027 , 13.321658 , 14.123765,
                15.193241,  16.262717,  15.46061,  14.658503 , 11.450076 , 9.578493 , 7.439541,
                7.439541 , 7.439541 , 7.70691 , 7.974279,  8.776386 , 9.043755 , 9.311124,
                7.70691 , 6.904803 , 6.904803 , 8.241648 , 6.96427,  10.915338 , 10.113231,
                7.70691 , 5.033221  ,3.429007,  3.696376,  3.963745,  5.033221 , 7.172172,
                9.043755  ,6.96427 , 11.182707,  10.915338 , 8.776386 , 7.172172,  4.765852,
                5.30059 , 5.835327 , 6.370065 , 6.637434 , 6.904803 , 7.439541 , 7.974279,
                8.776386  ,6.96427 , 12.252182 , 13.054289 , 14.123765  ,14.658503,  14.391134,
                13.856396 , 13.856396,  16.262717  ,18.669037,  21.610096 , 27.759582 , 32.572223,
                37.652233 , 43.801719,  46.20804  ,44.069088 , 38.186971 , 32.304854 , 26.690106,
                20.807989,  16.530086,  13.856396,  12.78692,  6.96427,  9.043755 , 8.241648,
                7.974279,  7.974279 , 8.776386  ,10.113231 , 10.915338 , 10.915338 , 10.113231,
                8.776386 , 7.974279 , 7.439541 , 7.70691 , 7.974279 , 8.241648,  7.974279,
                7.439541  ,8.776386 , 9.845862 , 11.717444 , 14.391134 , 15.995348 , 17.86693,
                18.134299 , 13.321658 , 12.519551 , 7.439541 , 7.172172 , 8.241648 , 9.311124,
                6.96427 , 20.034  ,30.2207 , 40.2377, 50.0849 , 54.1596 , 59.9321,
                70.1188 , 84.7199 , 99.6604  ,87.9457 , 82.343 , 68.4211  ,42.9542,
                30.2207 , 19.203775  ,13.856396 , 12.78692 , 12.252182,  11.984813 , 11.450076,
                11.182707 , 11.182707 , 10.113231 , 8.241648 , 6.637434 , 5.30059 , 4.498483,
                3.161638 , 3.963745 , 5.30059 , 6.370065 , 7.974279 , 10.113231 , 12.519551,
                13.054289 , 11.717444 , 9.043755 , 8.241648 , 6.904803  ,7.172172 , 7.439541,
                7.439541 , 7.439541 , 7.439541 , 7.172172,  6.904803 , 6.637434 , 6.102696,
                5.835327 , 5.567959 , 5.30059  ,5.033221 , 4.765852 , 4.498483 , 4.498483,
                5.567959 , 6.637434,  7.70691 , 7.70691,  7.172172 , 6.637434  ,5.835327,
                5.567959 , 5.033221 , 4.765852  ,4.765852 , 5.30059,  6.370065 , 6.904803,
                6.370065 , 5.835327,  4.765852,  4.231114 , 3.696376,  3.429007 , 3.161638,
                3.696376 , 3.963745 , 4.231114 , 5.033221 , 5.30059 , 5.567959 , 5.567959,
                5.835327,  5.835327 , 5.835327 , 5.30059 ,4.765852,  3.963745 , 3.963745,
                3.963745 , 4.765852  ,5.30059 , 5.30059  ,5.30059  ,5.30059 , 5.30059,
                5.033221 , 4.765852 , 4.765852 , 5.30059 , 5.567959 , 5.567959 , 5.30059,
                4.765852  ,4.231114 , 3.963745 , 4.231114 , 4.231114 , 4.231114 , 3.429007,
                3.161638 , 2.894269 , 3.696376 , 4.498483 , 6.370065 , 6.904803 , 6.637434,
                4.765852 , 4.765852 , 5.033221 , 6.102696  ,7.172172 , 7.172172 , 6.904803,
                6.637434 , 6.370065  ,6.370065,  6.637434 , 6.637434 , 7.172172 , 7.439541 , 7.439541,
                6.904803  ,5.835327 , 5.033221 , 4.498483  ,4.765852 , 6.102696 , 9.043755  ,10.647969,
                13.856396, 20.273251 , 26.422737 , 30.968009 , 32.572223,  27.492213,  22.412203 , 17.332193,
                12.252182 , 7.172172 , 8.241648 , 10.647969 , 12.252182 , 11.717444 , 8.509017  ,6.904803,
                5.033221,  3.963745  ,3.161638,  1.595778 , 2.894269 , 3.161638 , 3.696376  ,3.963745 , 3.963745,
                4.498483 , 5.033221 , 5.567959 , 6.370065  ,6.637434 , 7.172172,  6.904803  ,6.904803 , 7.439541,
                8.241648 , 8.776386  ,9.311124, 8.241648, 6.637434 , 6.370065 , 5.30059 , 4.498483,  3.963745,
                3.696376  ,3.963745,  5.033221 , 5.835327 , 6.370065 , 7.172172 , 7.974279  ,8.241648,  7.97427,
                6.904803, 5.567959,  4.498483,  4.765852 , 5.30059 , 5.567959 , 5.033221  ,4.498483  ,3.429007  ,
                3.963745 , 4.498483 , 5.033221, 5.30059,  5.033221 , 4.231114 , 3.696376,  3.161638 , 3.161638 ,
                3.161638 , 3.161638,  3.161638  ,3.161638,3.161638 , 2.894269,  2.894269  ])

plt.plot(x,f,"")

h0=(1+sqrt(3))/(8)
h1=(3+sqrt(3))/(8)
h2=(3-sqrt(3))/(8)
h3=(1-sqrt(3))/(8)

g0=h3
g1=-h2
g2=h1
g3=-h0

print('h = ',h0+h1+h2+h3)
print('g = ',g0+g1+g2+g3)
print('h = ',h0,"  ",h1,"  ",h2,"  ",h3)
print('g = ',g0," ", g1, "  ",g2,"  ", g3)

D=[]

for i in range(len(x)):
    if i<=len(x)-4:
        ai=h0*f[i]+h1*f[i+1]+h2*f[i+2]+h3*f[i+3]
        di=g0*f[i]+g1*f[i+1]+g2*f[i+2]+g3*f[i+3]

        D.append((ai+di))
        
    elif i==len(x)-3:
        ai=h0*f[i]+h1*f[i+1]+h2*f[i+2]+h3*f[0]
        di=g0*f[i]+g1*f[i+1]+g2*f[i+2]+g3*f[0]
        
        D.append((ai+di))
        
    elif i==len(x)-2:
        ai=h0*f[i]+h1*f[i+1]+h2*f[0]+h3*f[1]
        di=g0*f[i]+g1*f[i+1]+g2*f[0]+g3*f[1]
        
        D.append((ai+di))

    elif i==len(x)-1:
        ai=h0*f[i]+h1*f[0]+h2*f[1]+h3*f[2]
        di=g0*f[i]+g1*f[0]+g2*f[1]+g3*f[2]
        
        D.append((ai+di))

print(len(x), len(D))

plt.plot(x, D, '')
plt.show()
